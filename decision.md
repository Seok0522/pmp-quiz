# 주요 변경 이력 및 의사결정 로그 (Decision Log)

## 2023-10-27

### 초기 요구사항 분석 및 프로젝트 설정
- **요구사항:** 제공된 CSV(`pmp_engko_final_0.2.csv`)를 기반으로 한 PMP 학습용 정적 웹 애플리케이션 개발.
- **핵심 기능:** 문제 풀이, 채점, 해설 제공, 문제 이동, Gemini API를 활용한 개념 학습.
- **기술 결정:**
    - 별도의 백엔드 없이 HTML, CSS, JavaScript만으로 구성된 정적 페이지로 결정. (빠른 개발 및 배포 용이성)
    - CSV 파싱을 위해 `PapaParse` 라이브러리 도입.
    - AI 연동을 위해 `@google/generative-ai` SDK 사용.
- **문서화:** `PRD.md`와 `TRD.md`를 작성하여 프로젝트의 목표와 기술적 계획을 명확히 함.

### v1.0: 기본 기능 구현
- `index.html`, `css/style.css`, `js/script.js` 기본 구조 생성 및 기능 구현.
- **문제 발생:** Python 웹 서버 실행 시 `command not found` 오류 발생.
- **해결:** `.idx/dev.nix` 파일에 `pkgs.python311`를 추가하여 개발 환경에 Python을 설치하고, IDX의 웹 미리보기 기능으로 대체하여 서버 실행 문제를 해결함.

### v1.1: 1차 피드백 반영 (UI 및 데이터 로딩)
- **문제 발생:**
    1. CSV 데이터가 화면에 표시되지 않음.
    2. AI 개념 설명 UI가 기본적으로 활성화되어 있음.
- **의사결정 및 해결:**
    1. CSV 헤더 파싱의 안정성을 높이기 위해, 하드코딩된 헤더 이름 대신 CSV 파일의 컬럼 순서(index)를 기반으로 데이터를 읽도록 `js/script.js`의 파싱 로직을 수정함.
    2. AI 설명 UI를 기본적으로 숨기고, '개념 학습하기' 버튼 클릭 시에만 나타나도록 로직을 변경함. (모달 -> 일반 영역)

### v1.2: 2차 피드백 반영 (가독성 및 인코딩)
- **문제 발생:**
    1. 한글 텍스트 깨짐 현상 발생 (인코딩 문제).
    2. 문제 본문에 보기 내용이 포함되어 가독성이 떨어짐.
    3. 선택지가 없어지고 UI가 망가짐.
- **의사결정 및 해결:**
    1. `fetch` API로 CSV 파일을 `ArrayBuffer`로 읽은 후, `TextDecoder`를 사용하여 `EUC-KR` 인코딩으로 먼저 디코딩을 시도하고 실패 시 `UTF-8`로 재시도하는 로직을 추가하여 인코딩 문제를 해결함.
    2. 정규표현식을 사용하여 문제 본문과 보기("A.", "B." 등)를 분리하는 파싱 함수(`parseQuestionAndChoices`)를 고도화함.
    3. 분리된 보기를 기반으로 라디오 버튼과 레이블을 동적으로 생성하도록 렌더링 로직을 수정함.
    4. 영문 문제는 기본 숨김 처리하고 토글 버튼으로 제어하도록 UI 개선.

### v1.3: 3차 피드백 반영 (UX 개선)
- **문제 발생:**
    1. AI 응답 대기 시간이 길어 사용자가 진행 상황을 알 수 없음.
- **의사결정 및 해결:**
    1. Gemini API 호출을 단일 응답(`generateContent`)에서 스트리밍 방식(`generateContentStream`)으로 변경.
    2. API 응답 스트림을 실시간으로 화면에 텍스트로 렌더링하여 타이핑 효과를 구현.
    3. 응답 대기 시간 동안 프로그레스 바(Progress Bar)를 표시하여 사용자가 진행 상태를 시각적으로 인지할 수 있도록 UX를 대폭 개선함.

### v1.4: GitHub 배포 준비 및 보안 강화
- **요구사항:** GitHub Pages 배포.
- **문제 인식:** `js/script.js`에 하드코딩된 API 키가 있어 보안에 매우 취약함.
- **의사결정 및 해결:**
    1. 하드코딩된 API 키를 제거.
    2. 사용자가 처음 접속 시 API 키를 입력하면, 브라우저의 `localStorage`에 키를 저장하여 다음 방문부터는 자동으로 불러오도록 수정. (보안과 편의성 동시 해결)
    3. 저장된 키를 변경하거나 삭제할 수 있는 'API 키 관리' UI 추가.

### v1.5: 최종 기능 추가 및 UI 개선 (오답노트 등)
- **요구사항:**
    1. 오답노트 기능 추가.
    2. 오답 시 피드백 강화 및 오답노트 UI 개선.
    3. 모바일 환경 가독성 최적화.
    4. 제작자 연락처 및 전체 문제 수 표시.
- **의사결정 및 해결:**
    1. **오답노트:** 틀린 문제 번호를 `localStorage`에 배열 형태로 저장. '오답노트 보기' 클릭 시 저장된 목록을 읽어 화면을 전환하여 보여줌. (모달 -> 별도 화면 방식 채택)
    2. **UI 개선:**
        - 틀린 선택지에 붉은색 테두리와 배경을 추가하여 시각적 피드백 강화.
        - 오답노트 목록에 문제 내용 일부를 미리보기로 제공하여 사용성 증대.
        - CSS 미디어 쿼리를 사용하여 모바일 화면 전용 스타일(여백/폰트 크기 축소 등)을 추가.
        - 헤더에 제작자 이메일, 문제 번호 표시에 전체 문제 수를 함께 표기하도록 수정.
- **최종 결정:** 모든 기능 구현 및 개선이 완료되어 GitHub 배포 준비를 마침.
